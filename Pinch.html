<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pinch</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pinch.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">pinch-0.2.0.1: An alternative implementation of Thrift for Haskell.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) Abhinav Gupta 2015</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>Abhinav Gupta &lt;mail@abhinavg.net&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Pinch</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Serializing and deserializing</a></li><li><a href="#g:2">RPC</a></li><li><a href="#g:3">Pinchable</a><ul><li><a href="#g:4">Automatically deriving instances</a><ul><li><a href="#g:5">Structs and exceptions</a></li><li><a href="#g:6">Unions</a></li><li><a href="#g:7">Enums</a></li></ul></li><li><a href="#g:8">Manually writing instances</a><ul><li><a href="#g:9">Structs and exceptions</a></li><li><a href="#g:10">Unions</a></li><li><a href="#g:11">Enums</a></li></ul></li><li><a href="#g:12">Helpers</a><ul><li><a href="#g:13"><code>pinch</code></a></li><li><a href="#g:14"><code>unpinch</code></a></li></ul></li></ul></li><li><a href="#g:15">Value</a></li><li><a href="#g:16">Messages</a></li><li><a href="#g:17">Protocols</a></li><li><a href="#g:18">TType</a><ul><li><a href="#g:19">Tags</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Pinch defines machinery to specify how types can be encoded into or decoded
 from Thrift payloads.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:encode">encode</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; a -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:decode">decode</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a</li><li class="src short"><a href="#v:encodeMessage">encodeMessage</a> :: <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeMessage">decodeMessage</a> :: <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> <a href="Pinch.html#t:Message">Message</a></li><li class="src short"><span class="keyword">class</span> <a href="Pinch.html#t:IsTType">IsTType</a> (<a href="Pinch.html#t:Tag">Tag</a> a) =&gt; <a href="#t:Pinchable">Pinchable</a> a <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:Tag">Tag</a> a</li><li><a href="#v:pinch">pinch</a> :: a -&gt; <a href="Pinch.html#t:Value">Value</a> (<a href="Pinch.html#t:Tag">Tag</a> a)</li><li><a href="#v:unpinch">unpinch</a> :: <a href="Pinch.html#t:Value">Value</a> (<a href="Pinch.html#t:Tag">Tag</a> a) -&gt; <a href="Pinch.html#t:Parser">Parser</a> a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Parser">Parser</a> a</li><li class="src short"><a href="#v:runParser">runParser</a> :: <a href="Pinch.html#t:Parser">Parser</a> a -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Field">Field</a> n a = <a href="#v:Field">Field</a> a</li><li class="src short"><a href="#v:getField">getField</a> :: <a href="Pinch.html#t:Field">Field</a> n a -&gt; a</li><li class="src short"><a href="#v:putField">putField</a> :: a -&gt; <a href="Pinch.html#t:Field">Field</a> n a</li><li class="src short"><a href="#v:field">field</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Functor.html#t:Functor">Functor</a> f =&gt; (a -&gt; f b) -&gt; <a href="Pinch.html#t:Field">Field</a> n a -&gt; f (<a href="Pinch.html#t:Field">Field</a> n b)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Void">Void</a> = <a href="#v:Void">Void</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Enumeration">Enumeration</a> n = <a href="#v:Enumeration">Enumeration</a></li><li class="src short"><a href="#v:enum">enum</a> :: <a href="Pinch.html#t:Enumeration">Enumeration</a> n</li><li class="src short"><a href="#v:.-61-">(.=)</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; a -&gt; <a href="Pinch.html#t:FieldPair">FieldPair</a></li><li class="src short"><a href="#v:-63--61-">(?=)</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Pinch.html#t:FieldPair">FieldPair</a></li><li class="src short"><a href="#v:struct">struct</a> :: [<a href="Pinch.html#t:FieldPair">FieldPair</a>] -&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a></li><li class="src short"><a href="#v:union">union</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; a -&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TUnion">TUnion</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FieldPair">FieldPair</a> = (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pinch.html#t:SomeValue">SomeValue</a>)</li><li class="src short"><a href="#v:.:">(.:)</a> :: <span class="keyword">forall</span> a. <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="Pinch.html#t:Parser">Parser</a> a</li><li class="src short"><a href="#v:.:-63-">(.:?)</a> :: <span class="keyword">forall</span> a. <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="Pinch.html#t:Parser">Parser</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Value">Value</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:SomeValue">SomeValue</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:SomeValue">SomeValue</a> :: <a href="Pinch.html#t:IsTType">IsTType</a> a =&gt; !(<a href="Pinch.html#t:Value">Value</a> a) -&gt; <a href="Pinch.html#t:SomeValue">SomeValue</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Message">Message</a></li><li class="src short"><a href="#v:mkMessage">mkMessage</a> :: (<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="Pinch.html#t:Tag">Tag</a> a ~ <a href="Pinch.html#t:TStruct">TStruct</a>) =&gt; <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="Pinch.html#t:MessageType">MessageType</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int32">Int32</a> -&gt; a -&gt; <a href="Pinch.html#t:Message">Message</a></li><li class="src short"><a href="#v:messageName">messageName</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:messageType">messageType</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="Pinch.html#t:MessageType">MessageType</a></li><li class="src short"><a href="#v:messageId">messageId</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int32">Int32</a></li><li class="src short"><a href="#v:getMessageBody">getMessageBody</a> :: (<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="Pinch.html#t:Tag">Tag</a> a ~ <a href="Pinch.html#t:TStruct">TStruct</a>) =&gt; <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:MessageType">MessageType</a><ul class="subs"><li>= <a href="#v:Call">Call</a></li><li>| <a href="#v:Reply">Reply</a></li><li>| <a href="#v:Exception">Exception</a></li><li>| <a href="#v:Oneway">Oneway</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Protocol">Protocol</a></li><li class="src short"><a href="#v:binaryProtocol">binaryProtocol</a> :: <a href="Pinch.html#t:Protocol">Protocol</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TType">TType</a> a</li><li class="src short"><span class="keyword">class</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a =&gt; <a href="#t:IsTType">IsTType</a> a <span class="keyword">where</span><ul class="subs"><li><a href="#v:ttype">ttype</a> :: <a href="Pinch.html#t:TType">TType</a> a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:TBool">TBool</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TByte">TByte</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TDouble">TDouble</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TEnum">TEnum</a> = <a href="Pinch.html#t:TInt32">TInt32</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TInt16">TInt16</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TInt32">TInt32</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TInt64">TInt64</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TBinary">TBinary</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TStruct">TStruct</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TUnion">TUnion</a> = <a href="Pinch.html#t:TStruct">TStruct</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TException">TException</a> = <a href="Pinch.html#t:TStruct">TStruct</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TMap">TMap</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TSet">TSet</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TList">TList</a></li></ul></div><div id="interface"><h1 id="g:1">Serializing and deserializing</h1><div class="doc"><p>Types that can be serialized and deserialized into/from Thrift values
 implement the <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> typeclass. Instances may be derived automatically
 using generics, or written out by hand.</p><p>The <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> typeclass converts objects into and from <code><a href="Pinch.html#t:Value">Value</a></code> objects,
 which act as a direct mapping to the Thrift wire representation.  A
 <code><a href="Pinch.html#t:Protocol">Protocol</a></code> is responsible for converting <code><a href="Pinch.html#t:Value">Value</a></code> objects to and from
 bytestrings.</p><p>The <code><a href="Pinch.html#v:encode">encode</a></code> and <code><a href="Pinch.html#v:decode">decode</a></code> methods may be used on objects that implement the
 <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> typeclass to get the wire representation directly.</p><pre>+------------+   Pinchable                    Protocol    +------------+
|            |               +------------+               |            |
|            +----pinch------&gt;            +---serialize---&gt;            |
| Your Type  |               |  Value a   |               | ByteString |
|            &lt;---unpinch-----+            &lt;--deserialize--+            |
|            |               +------------+               |            |
|            |                                            |            |
|            +-------------------encode-------------------&gt;            |
|            |                                            |            |
|            &lt;-------------------decode-------------------+            |
+------------+                                            +------------+</pre></div><div class="top"><p class="src"><a name="v:encode" class="def">encode</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; a -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L195" class="link">Source</a></p><div class="doc"><p>Encode the given <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> value using the given <code><a href="Pinch.html#t:Protocol">Protocol</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>unpack $ encode binaryProtocol [&quot;a&quot; :: ByteString, &quot;b&quot;]
</code></strong>[11,0,0,0,2,0,0,0,1,97,0,0,0,1,98]
</pre></div></div><div class="top"><p class="src"><a name="v:decode" class="def">decode</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L205" class="link">Source</a></p><div class="doc"><p>Decode a <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> value from the using the given <code><a href="Pinch.html#t:Protocol">Protocol</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let s = pack [11,0,0,0,2,0,0,0,1,97,0,0,0,1,98]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>decode binaryProtocol s :: Either String [ByteString]
</code></strong>Right [&quot;a&quot;,&quot;b&quot;]
</pre></div></div><h1 id="g:2">RPC</h1><div class="doc"><p>Thrift requests implicitly form a struct and responses implicitly form a
 union. To send/receive the request/response, it must be wrapped inside a
 <code><a href="Pinch.html#t:Message">Message</a></code>. The <code><a href="Pinch.html#t:Message">Message</a></code> contains information like the method name, the
 message ID (to match out of order responses with requests), and whether
 it contains a request or a response.</p><p>Requests and responses may be wrapped into <code>Message</code> objects using the
 <code><a href="Pinch.html#v:mkMessage">mkMessage</a></code> function. The message body can be retrieved back using the
 <code><a href="Pinch.html#v:getMessageBody">getMessageBody</a></code> function. The <code><a href="Pinch.html#v:encodeMessage">encodeMessage</a></code> and <code><a href="Pinch.html#v:decodeMessage">decodeMessage</a></code>
 functions may be used to encode and decode messages into/from bytestrings.</p><p>Consider the service method,</p><pre>User getUser(1: string userName, 2: list&lt;Attribute&gt; attributes)
  throws (1: UserDoesNotExist doesNotExist,
          2: InternalError internalError)</pre><p>The request and response for this method implictly take the form:</p><pre>struct getUserRequest {
  1: string userName
  2: list&lt;Attribute&gt; attributes
}</pre><pre>union getUserResponse {
  0: User success
  1: UserDoesNotExist doesNotExist
  2: InternalError InternalError
}</pre><p>(Note that the field ID 0 is reserved for the return value of the method.)</p><p>Given corresponding data types <code>GetUserRequest</code> and <code>GetUserResponse</code>, the
 client can do something similar to,</p><pre>let req = GetUserRequest &quot;jsmith&quot; []
    msg = <code><a href="Pinch.html#v:mkMessage">mkMessage</a></code> &quot;getUser&quot; <code><a href="Pinch.html#v:Call">Call</a></code> 0 req
response &lt;- sendToServer (<code><a href="Pinch.html#v:encodeMessage">encodeMessage</a></code> msg)
case <code><a href="Pinch.html#v:decodeMessage">decodeMessage</a></code> response of
    Left err -&gt; handleError err
    Right msg -&gt; case <code><a href="Pinch.html#v:getMessageBody">getMessageBody</a></code> msg of
        Left err -&gt; handleError err
        Right (res :: GetUserResponse) -&gt; handleResponse res
</pre><p>Similarly, on the server side,</p><pre>case decodeMessage request of
    Left err -&gt; handleError err
    Right msg -&gt; case <code><a href="Pinch.html#v:messageName">messageName</a></code> msg of
        &quot;getUser&quot; -&gt; case getMessageBody msg of
            Left err -&gt; handleError err
            Right (req :: GetUserRequest) -&gt; do
                let mid = <code><a href="Pinch.html#v:messageId">messageId</a></code> msg
                res &lt;- handleGetUser req
                return (mkMessage &quot;getUser&quot; <code><a href="Pinch.html#v:Reply">Reply</a></code> mid res)
                -- Note that the response MUST contain the same
                -- message ID as its request.
        _ -&gt; handleUnknownMethod
</pre></div><div class="top"><p class="src"><a name="v:encodeMessage" class="def">encodeMessage</a> :: <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L284" class="link">Source</a></p><div class="doc"><p>Encode the <code><a href="Pinch.html#t:Message">Message</a></code> using the given <code><a href="Pinch.html#t:Protocol">Protocol</a></code>.</p><pre>let request = GetUserRequest (putField &quot;jsmith&quot;) (putField [])
    message = <code><a href="Pinch.html#v:mkMessage">mkMessage</a></code> &quot;getUser&quot; Call 42 request
in encodeMessage binaryProtocol message
</pre></div></div><div class="top"><p class="src"><a name="v:decodeMessage" class="def">decodeMessage</a> :: <a href="Pinch.html#t:Protocol">Protocol</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> <a href="Pinch.html#t:Message">Message</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L293" class="link">Source</a></p><div class="doc"><p>Decode a <code><a href="Pinch.html#t:Message">Message</a></code> using the given <code><a href="Pinch.html#t:Protocol">Protocol</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>decodeMessage binaryProtocol bs &gt;&gt;= getMessageBody :: Either String GetUserRequest
</code></strong>Right (GetUserRequest {userName = Field &quot;jsmith&quot;, userAttributes = Field []})
</pre></div></div><h1 id="g:3">Pinchable</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="Pinch.html#t:IsTType">IsTType</a> (<a href="Pinch.html#t:Tag">Tag</a> a) =&gt; <a name="t:Pinchable" class="def">Pinchable</a> a <span class="keyword">where</span> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L102" class="link">Source</a></p><div class="doc"><p>The Pinchable type class is implemented by types that can be sent or
 received over the wire as Thrift payloads.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src">Nothing</p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a name="t:Tag" class="def">Tag</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L110" class="link">Source</a></p><div class="doc"><p><code><a href="Pinch.html#t:TType">TType</a></code> tag for this type.</p><p>For most custom types, this will be <code><a href="Pinch.html#t:TStruct">TStruct</a></code>, <code><a href="Pinch.html#t:TUnion">TUnion</a></code>, or
 <code><a href="Pinch.html#t:TException">TException</a></code>. For enums, it will be <code><a href="Pinch.html#t:TEnum">TEnum</a></code>. If the instance
 automatically derived with use of <code>Generic</code>, this is not required
 because it is automatically determined by use of <code>Field</code> or
 <code>Enumeration</code>.</p></div></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:pinch" class="def">pinch</a> :: a -&gt; <a href="Pinch.html#t:Value">Value</a> (<a href="Pinch.html#t:Tag">Tag</a> a) <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L102" class="link">Source</a></p><div class="doc"><p>Convert an <code>a</code> into a <code><a href="Pinch.html#t:Value">Value</a></code>.</p><p>For structs, <code><a href="Pinch.html#v:struct">struct</a></code>, <code><a href="Pinch.html#v:.-61-">.=</a></code>, and <code><a href="Pinch.html#v:-63--61-">?=</a></code> may be used to construct
 <code><a href="Pinch.html#t:Value">Value</a></code> objects tagged with <code><a href="Pinch.html#t:TStruct">TStruct</a></code>.</p></div><p class="src"><a name="v:unpinch" class="def">unpinch</a> :: <a href="Pinch.html#t:Value">Value</a> (<a href="Pinch.html#t:Tag">Tag</a> a) -&gt; <a href="Pinch.html#t:Parser">Parser</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L102" class="link">Source</a></p><div class="doc"><p>Read a <code><a href="Pinch.html#t:Value">Value</a></code> back into an <code>a</code>.</p><p>For structs, <code><a href="Pinch.html#v:.:">.:</a></code> and <code><a href="Pinch.html#v:.:-63-">.:?</a></code> may be used to retrieve field values.</p></div></div><div class="subs instances"><p id="control.i:Pinchable" class="caption collapser" onclick="toggleSection('i:Pinchable')">Instances</p><div id="section.i:Pinchable" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Bool.html#t:Bool">Bool</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Double">Double</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int8">Int8</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int32">Int32</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int64">Int64</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString.html#t:ByteString">ByteString</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/bytestring/latest/doc/html/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text-Lazy.html#t:Text">Text</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text.html#t:Text">Text</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> [a]</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> a, <a href="Pinch.html#t:Pinchable">Pinchable</a> a) =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Set.html#t:Set">Set</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> a, <a href="http://hackage.haskell.org/packages/archive/hashable/latest/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> a, <a href="Pinch.html#t:Pinchable">Pinchable</a> a) =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="http://hackage.haskell.org/packages/archive/unordered-containers/latest/doc/html/Data-HashSet.html#t:HashSet">HashSet</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="http://hackage.haskell.org/packages/archive/vector/latest/doc/html/Data-Vector.html#t:Vector">Vector</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> a =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> k, <a href="Pinch.html#t:Pinchable">Pinchable</a> k, <a href="Pinch.html#t:Pinchable">Pinchable</a> v) =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html#t:Map">Map</a> k v)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> k, <a href="http://hackage.haskell.org/packages/archive/hashable/latest/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> k, <a href="Pinch.html#t:Pinchable">Pinchable</a> k, <a href="Pinch.html#t:Pinchable">Pinchable</a> v) =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="http://hackage.haskell.org/packages/archive/unordered-containers/latest/doc/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> k v)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Parser" class="def">Parser</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable/Parser.hs#L29" class="link">Source</a></p><div class="doc"><p>A simple continuation-based parser.</p><p>This is just <code>Either e a</code> in continuation-passing style.</p></div><div class="subs instances"><p id="control.i:Parser" class="caption collapser" onclick="toggleSection('i:Parser')">Instances</p><div id="section.i:Parser" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#t:Monad">Monad</a> <a href="Pinch.html#t:Parser">Parser</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Functor.html#t:Functor">Functor</a> <a href="Pinch.html#t:Parser">Parser</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#t:Applicative">Applicative</a> <a href="Pinch.html#t:Parser">Parser</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Applicative.html#t:Alternative">Alternative</a> <a href="Pinch.html#t:Parser">Parser</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#t:MonadPlus">MonadPlus</a> <a href="Pinch.html#t:Parser">Parser</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:runParser" class="def">runParser</a> :: <a href="Pinch.html#t:Parser">Parser</a> a -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable/Parser.hs#L84" class="link">Source</a></p><div class="doc"><p>Run a <code>Parser</code> and return the result inside an <code>Either</code>.</p></div></div><h2 id="g:4">Automatically deriving instances</h2><div class="doc"><p>Pinch supports deriving instances of <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> automatically for
 types that implement the <code>Generic</code> typeclass provided that they follow
 the outlined patterns in their constructors.</p></div><h3 id="g:5">Structs and exceptions</h3><div class="doc"><p>Given the struct,</p><pre>struct User {
  1: required string name
  2: optional string emailAddress
}</pre><p>A <code>Pinchable</code> instance for it can be automatically derived by wrapping
 fields of the data type with the <code><a href="Pinch.html#t:Field">Field</a></code> type and specifying the field
 identifier as a type-level numeral. Fields which hold a <code>Maybe</code> value are
 considered optional.</p><pre>data User = User
    { userName         :: <code><a href="Pinch.html#t:Field">Field</a></code> 1 Text
    , userEmailAddress :: Field 2 (Maybe Text)
    }
  deriving (Generic)

instance Pinchable User
</pre><p>The <code>DeriveGeneric</code> extension is required to automatically derive instances
 of the <code>Generic</code> typeclass and the <code>DataKinds</code> extension is required to use
 type-level numerals.</p></div><h3 id="g:6">Unions</h3><div class="doc"><p>As with structs and exceptions, fields of the data type representing a
 union must be tagged with <code><a href="Pinch.html#t:Field">Field</a></code>, but to satisfy the property of a union
 that only one value is set at a time, they must be on separate
 constructors.</p><p>For example, given the union,</p><pre>union Item {
  1: binary bin
  2: string str
  3: i32    int
}</pre><p>A <code>Pinchable</code> instance can be derived like so,</p><pre>data Item
    = ItemBin (Field 1 ByteString)
    | ItemStr (Field 2 Text)
    | ItemInt (Field 3 Int32)
  deriving (Generic)

instance Pinchable Item</pre><p>The <code>DeriveGeneric</code> extension is required to automatically derive instances
 of the <code>Generic</code> typeclass and the <code>DataKinds</code> extension is required to use
 type-level numerals.</p><p>If the union represents the response of a service method which returns a
 <code>void</code> result, the type <code><a href="Pinch.html#t:Void">Void</a></code> may be used.</p><pre>data GetFooResponse
  = GetFooDoesNotExist  (Field 1 FooDoesNotExist)
  | GetFooInternalError (Field 2 InternalError)
  | GetFooSuccess <code><a href="Pinch.html#t:Void">Void</a></code>
</pre></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a name="t:Field" class="def">Field</a> n a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L127" class="link">Source</a></p><div class="doc"><p>Fields of data types that represent structs, unions, and exceptions
 should be wrapped inside <code><a href="Pinch.html#t:Field">Field</a></code> and tagged with the field identifier.</p><pre>data Foo = Foo (Field 1 Text) (Field 2 (Maybe Int32)) deriving Generic
instance Pinchable Foo</pre><pre>data A = A (Field 1 Int32) | B (Field 2 Text) deriving Generic
instance Pinchable Foo</pre><p>Fields which hold <code>Maybe</code> values are treated as optional. All fields values
 must be <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> to automatically derive a <code>Pinchable</code> instance for the
 new data type.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Field" class="def">Field</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Field" class="caption collapser" onclick="toggleSection('i:Field')">Instances</p><div id="section.i:Field" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Functor.html#t:Functor">Functor</a> (<a href="Pinch.html#t:Field">Field</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Foldable.html#t:Foldable">Foldable</a> (<a href="Pinch.html#t:Field">Field</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Traversable.html#t:Traversable">Traversable</a> (<a href="Pinch.html#t:Field">Field</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Bounded">Bounded</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Bounded">Bounded</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Enum">Enum</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Enum">Enum</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Generic">Generic</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#t:Monoid">Monoid</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#t:Monoid">Monoid</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; <a href="Pinch-Internal-Pinchable.html#t:GPinchable">GPinchable</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Field">Field</a> n (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; <a href="Pinch-Internal-Pinchable.html#t:GPinchable">GPinchable</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Field">Field</a> n a))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Rep">Rep</a> (<a href="Pinch.html#t:Field">Field</a> n a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Pinch-Internal-Pinchable.html#t:GTag">GTag</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Field">Field</a> n (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a))) = <a href="Pinch.html#t:TStruct">TStruct</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Pinch-Internal-Pinchable.html#t:GTag">GTag</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Field">Field</a> n a)) = <a href="Pinch.html#t:TStruct">TStruct</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:getField" class="def">getField</a> :: <a href="Pinch.html#t:Field">Field</a> n a -&gt; a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L136" class="link">Source</a></p><div class="doc"><p>Gets the current value of a field.</p><pre>let Foo a' _ = {- ... -}
    a = getField a'</pre></div></div><div class="top"><p class="src"><a name="v:putField" class="def">putField</a> :: a -&gt; <a href="Pinch.html#t:Field">Field</a> n a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L142" class="link">Source</a></p><div class="doc"><p>Puts a value inside a field.</p><pre>Foo (putField &quot;Hello&quot;) (putField (Just 42))</pre></div></div><div class="top"><p class="src"><a name="v:field" class="def">field</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Functor.html#t:Functor">Functor</a> f =&gt; (a -&gt; f b) -&gt; <a href="Pinch.html#t:Field">Field</a> n a -&gt; f (<a href="Pinch.html#t:Field">Field</a> n b) <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L149" class="link">Source</a></p><div class="doc"><p>A lens on <code>Field</code> wrappers for use with the lens library.</p><pre>person &amp; name . field .~ &quot;new value&quot;</pre></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Void" class="def">Void</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L228" class="link">Source</a></p><div class="doc"><p>Represents a <code>void</code> result for methods.</p><p>This should be used as an element in a response union along with <code><a href="Pinch.html#t:Field">Field</a></code>
 tags.</p><p>For a method,</p><pre>void setValue(..) throws
  (1: ValueAlreadyExists alreadyExists,
   2: InternalError internalError)</pre><p>Something similar to the following can be used.</p><pre>data SetValueResponse
  = SetValueAlreadyExists (Field 1 ValueAlreadyExists)
  | SetValueInternalError (Field 2 InternalError)
  | SetValueSuccess Void
  deriving (Generic)

instance Pinchable SetValueResponse</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Void" class="def">Void</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Void" class="caption collapser" onclick="toggleSection('i:Void')">Instances</p><div id="section.i:Void" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Pinch.html#t:Void">Void</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> <a href="Pinch.html#t:Void">Void</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> <a href="Pinch.html#t:Void">Void</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Generic">Generic</a> <a href="Pinch.html#t:Void">Void</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch-Internal-Pinchable.html#t:GPinchable">GPinchable</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i <a href="Pinch.html#t:Void">Void</a>)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Rep">Rep</a> <a href="Pinch.html#t:Void">Void</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Pinch-Internal-Pinchable.html#t:GTag">GTag</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i <a href="Pinch.html#t:Void">Void</a>) = <a href="Pinch.html#t:TStruct">TStruct</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h3 id="g:7">Enums</h3><div class="doc"><p>Given the enum,</p><pre>enum Op {
  Add, Sub, Mul, Div
}</pre><p>A <code>Pinchable</code> instance can be derived for it by creating one constructor
 for each of the enum values and providing it a single <code><a href="Pinch.html#t:Enumeration">Enumeration</a></code>
 argument tagged with the enum value.</p><pre>data Op
    = OpAdd (<code><a href="Pinch.html#t:Enumeration">Enumeration</a></code> 0)
    | OpSub (Enumeration 1)
    | OpMul (Enumeration 2)
    | OpDiv (Enumeration 3)
  deriving (Generic)

instance Pinchable Op
</pre><p>Note that you need to know the values assigned to the enums. If not
 specified, Thrift automatically assigns incrementing values to the items in
 the order they appear starting at 0.</p><p>The <code>DeriveGeneric</code> extension is required to automatically derive instances
 of the <code>Generic</code> typeclass and the <code>DataKinds</code> extension is required to use
 type-level numerals.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Enumeration" class="def">Enumeration</a> n <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L184" class="link">Source</a></p><div class="doc"><p>Data types that represent Thrift enums must have one constructor for each
 enum item accepting an <code><a href="Pinch.html#t:Enumeration">Enumeration</a></code> object tagged with the corresponding
 enum value.</p><pre>data Role = RoleUser (Enumeration 1) | RoleAdmin (Enumeration 2)
  deriving Generic
instance Pinchable Role</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Enumeration" class="def">Enumeration</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Enumeration" class="caption collapser" onclick="toggleSection('i:Enumeration')">Instances</p><div id="section.i:Enumeration" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Ord.html#t:Ord">Ord</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Generic">Generic</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; <a href="Pinch-Internal-Pinchable.html#t:GPinchable">GPinchable</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Enumeration">Enumeration</a> n))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Rep">Rep</a> (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Pinch-Internal-Pinchable.html#t:GTag">GTag</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:K1">K1</a> i (<a href="Pinch.html#t:Enumeration">Enumeration</a> n)) = <a href="Pinch.html#t:TEnum">TEnum</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:enum" class="def">enum</a> :: <a href="Pinch.html#t:Enumeration">Enumeration</a> n <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Generic.hs#L193" class="link">Source</a></p><div class="doc"><p>Convenience function to construct <code><a href="Pinch.html#t:Enumeration">Enumeration</a></code> objects.</p><pre>let role = RoleUser enum</pre></div></div><h2 id="g:8">Manually writing instances</h2><div class="doc"><p>Instances of <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> can be constructed by composing together
 existing instances and using the <code><a href="Pinch.html#v:.-61-">.=</a></code>, <code><a href="Pinch.html#v:.:">.:</a></code>, etc. helpers.</p></div><h3 id="g:9">Structs and exceptions</h3><div class="doc"><p>Given a Thrift struct,</p><pre>struct Post {
  1: optional string subject
  2: required string body
}</pre><p>The <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> instance for it will be,</p><pre>data Post = Post
    { postSubject :: Maybe Text
    , postBody    :: Text
    }

instance <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> Post where
    type <code><a href="Pinch.html#t:Tag">Tag</a></code> Post = <code><a href="Pinch.html#t:TStruct">TStruct</a></code>

    pinch (Post subject body) =
        <code><a href="Pinch.html#v:struct">struct</a></code> [ 1 <code><a href="Pinch.html#v:-63--61-">?=</a></code> subject
               , 2 <code><a href="Pinch.html#v:.-61-">.=</a></code> body
               ]

    unpinch value =
        Post &lt;$&gt; value <code><a href="Pinch.html#v:.:-63-">.:?</a></code> 1
             &lt;*&gt; value <code><a href="Pinch.html#v:.:">.:</a></code>  2
</pre></div><h3 id="g:10">Unions</h3><div class="doc"><p>Given a Thrift union,</p><pre>union PostBody {
  1: string markdown
  2: binary rtf
}</pre><p>The <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> instance for it will be,</p><pre>data PostBody
    = PostBodyMarkdown Text
    | PostBodyRtf ByteString

instance Pinchable PostBody where
    type Tag PostBody = <code><a href="Pinch.html#t:TUnion">TUnion</a></code>

    pinch (PostBodyMarkdown markdownBody) =
        <code><a href="Pinch.html#v:union">union</a></code> 1 markdownBody
    pinch (PostBodyRtf rtfBody) =
        union 2 rtfBody

    unpinch v = PostBodyMarkdown &lt;$&gt; v .: 1
            &lt;|&gt; PostBodyRtf      &lt;$&gt; v .: 2
</pre></div><h3 id="g:11">Enums</h3><div class="doc"><p>Given an enum,</p><pre>enum Role {
  DISABLED = 0,
  USER,
  ADMIN,
}</pre><p>The <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> instance for it will be,</p><pre>data Role = RoleDisabled | RoleUser | RoleAdmin

instance Pinchable Role where
    type Tag Role = TEnum

    pinch RoleDisabled = pinch (0 :: Int32)
    pinch RoleUser     = pinch (1 :: Int32)
    pinch RoleAdmin    = pinch (2 :: Int32)

    unpinch v = do
       value &lt;- unpinch v
       case (value :: Int32) of
           0 -&gt; Right RoleDisabled
           1 -&gt; Right RoleUser
           2 -&gt; Right RoleAdmin
           _ -&gt; Left $ &quot;Unknown role: &quot; ++ show value</pre></div><h2 id="g:12">Helpers</h2><h3 id="g:13"><code>pinch</code></h3><div class="top"><p class="src"><a name="v:.-61-" class="def">(.=)</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; a -&gt; <a href="Pinch.html#t:FieldPair">FieldPair</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L141" class="link">Source</a></p><div class="doc"><p>Construct a <code><a href="Pinch.html#t:FieldPair">FieldPair</a></code> from a field identifier and a <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> value.</p></div></div><div class="top"><p class="src"><a name="v:-63--61-" class="def">(?=)</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; <a href="Pinch.html#t:FieldPair">FieldPair</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L146" class="link">Source</a></p><div class="doc"><p>Construct a <code><a href="Pinch.html#t:FieldPair">FieldPair</a></code> from a field identifier and an optional
 <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code> value.</p></div></div><div class="top"><p class="src"><a name="v:struct" class="def">struct</a> :: [<a href="Pinch.html#t:FieldPair">FieldPair</a>] -&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L153" class="link">Source</a></p><div class="doc"><p>Construct a <code><a href="Pinch.html#t:Value">Value</a></code> tagged with a <code><a href="Pinch.html#t:TStruct">TStruct</a></code> from the given key-value
 pairs. Optional fields whose values were omitted will be ignored.</p><pre>struct [1 .= (&quot;Hello&quot; :: Text), 2 .= (42 :: Int16)]</pre></div></div><div class="top"><p class="src"><a name="v:union" class="def">union</a> :: <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; a -&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TUnion">TUnion</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L163" class="link">Source</a></p><div class="doc"><p>Constructs a <code><a href="Pinch.html#t:Value">Value</a></code> tagged with <code><a href="Pinch.html#t:TUnion">TUnion</a></code>.</p><pre>union 1 (&quot;foo&quot; :: ByteString)</pre></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:FieldPair" class="def">FieldPair</a> = (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Pinch.html#t:SomeValue">SomeValue</a>) <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L138" class="link">Source</a></p><div class="doc"><p>A pair of field identifier and maybe a value stored in the field. If the
 value is absent, the field will be ignored.</p></div></div><h3 id="g:14"><code>unpinch</code></h3><div class="top"><p class="src"><a name="v:.:" class="def">(.:)</a> :: <span class="keyword">forall</span> a. <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="Pinch.html#t:Parser">Parser</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L169" class="link">Source</a></p><div class="doc"><p>Given a field ID and a <code>Value TStruct</code>, get the value stored in the
 struct under that field ID. The lookup fails if the field is absent or if
 it's not the same type as expected by this call's context.</p></div></div><div class="top"><p class="src"><a name="v:.:-63-" class="def">(.:?)</a> :: <span class="keyword">forall</span> a. <a href="Pinch.html#t:Pinchable">Pinchable</a> a =&gt; <a href="Pinch.html#t:Value">Value</a> <a href="Pinch.html#t:TStruct">TStruct</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int16">Int16</a> -&gt; <a href="Pinch.html#t:Parser">Parser</a> (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a) <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Pinchable.hs#L188" class="link">Source</a></p><div class="doc"><p>Given a field ID and a <code>Value TStruct</code>, get the optional value stored in
 the struct under the given field ID. The value returned is <code>Nothing</code> if it
 was absent or the wrong type. The lookup fails only if the value retrieved
 fails to <code><a href="Pinch.html#v:unpinch">unpinch</a></code>.</p></div></div><h1 id="g:15">Value</h1><div class="doc"><p><code><a href="Pinch.html#t:Value">Value</a></code> is an intermediate representation of Thrift payloads tagged
 with TType tags. Types that want to be serialized into/deserialized
 from Thrift payloads need only define a way to convert themselves to
 and from <code><a href="Pinch.html#t:Value">Value</a></code> objects via <code><a href="Pinch.html#t:Pinchable">Pinchable</a></code>.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Value" class="def">Value</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Value.hs#L61" class="link">Source</a></p><div class="doc"><p><code>Value</code> maps directly to serialized representation of Thrift types. It
 contains about as much information as what gets sent over the wire.
 <code>Value</code> objects are tagged with different <code><a href="Pinch.html#t:TType">TType</a></code> values to indicate the
 type of the value.</p><p>Typical usage will not involve accessing the constructors for this type.
 <code><a href="Pinch-Pinchable.html#v:Pinchable">Pinchable</a></code> must be used to construct <code><a href="Pinch.html#t:Value">Value</a></code> objects or
 convert them back to original types.</p></div><div class="subs instances"><p id="control.i:Value" class="caption collapser" onclick="toggleSection('i:Value')">Instances</p><div id="section.i:Value" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/hashable/latest/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> a =&gt; <a href="Pinch.html#t:Pinchable">Pinchable</a> (<a href="Pinch.html#t:Value">Value</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="Pinch.html#t:Tag">Tag</a> (<a href="Pinch.html#t:Value">Value</a> a) = a</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SomeValue" class="def">SomeValue</a> <span class="keyword">where</span> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Value.hs#L132" class="link">Source</a></p><div class="doc"><p><code><a href="Pinch.html#t:SomeValue">SomeValue</a></code> holds any value, regardless of type. This may be used when
 the type of the value is not necessarily known at compile time. Typically,
 this will be pattern matched on and code that depends on the value's
 <code><a href="Pinch.html#t:TType">TType</a></code> will go inside the scope of the match.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SomeValue" class="def">SomeValue</a> :: <a href="Pinch.html#t:IsTType">IsTType</a> a =&gt; !(<a href="Pinch.html#t:Value">Value</a> a) -&gt; <a href="Pinch.html#t:SomeValue">SomeValue</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:SomeValue" class="caption collapser" onclick="toggleSection('i:SomeValue')">Instances</p><div id="section.i:SomeValue" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Pinch.html#t:SomeValue">SomeValue</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> <a href="Pinch.html#t:SomeValue">SomeValue</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Pinch.html#t:SomeValue">SomeValue</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/hashable/latest/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> <a href="Pinch.html#t:SomeValue">SomeValue</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:16">Messages</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Message" class="def">Message</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Message.hs#L55" class="link">Source</a></p><div class="doc"><p>Message envelope for Thrift payloads.</p></div><div class="subs instances"><p id="control.i:Message" class="caption collapser" onclick="toggleSection('i:Message')">Instances</p><div id="section.i:Message" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Pinch.html#t:Message">Message</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> <a href="Pinch.html#t:Message">Message</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Generic">Generic</a> <a href="Pinch.html#t:Message">Message</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Pinch.html#t:Message">Message</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Rep">Rep</a> <a href="Pinch.html#t:Message">Message</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:mkMessage" class="def">mkMessage</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L298" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="Pinch.html#t:Tag">Tag</a> a ~ <a href="Pinch.html#t:TStruct">TStruct</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text.html#t:Text">Text</a></td><td class="doc"><p>Name of the target method.</p></td></tr><tr><td class="src">-&gt; <a href="Pinch.html#t:MessageType">MessageType</a></td><td class="doc"><p>Type of the message.</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int32">Int32</a></td><td class="doc"><p>Message ID.</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Message payload. This must be an object which serializes into a
 struct.</p></td></tr><tr><td class="src">-&gt; <a href="Pinch.html#t:Message">Message</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Build a <code>Message</code>.</p></div></div><div class="top"><p class="src"><a name="v:messageName" class="def">messageName</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/text/latest/doc/html/Data-Text.html#t:Text">Text</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Message.hs#L56" class="link">Source</a></p><div class="doc"><p>Name of the method to which this message is targeted.</p></div></div><div class="top"><p class="src"><a name="v:messageType" class="def">messageType</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="Pinch.html#t:MessageType">MessageType</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Message.hs#L58" class="link">Source</a></p><div class="doc"><p>Type of the message.</p></div></div><div class="top"><p class="src"><a name="v:messageId" class="def">messageId</a> :: <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int32">Int32</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Message.hs#L60" class="link">Source</a></p><div class="doc"><p>Sequence ID of the message.</p><p>If the clients expect to receive out-of-order responses, they may use
 the message ID to map responses back to their corresponding requests.
 If the client does not expect out-of-order responses, they are free to
 use the same message ID for all messages.</p><p>The server's contract regarding message IDs is that all responses must
 have the same message ID as their corresponding requests.</p></div></div><div class="top"><p class="src"><a name="v:getMessageBody" class="def">getMessageBody</a> :: (<a href="Pinch.html#t:Pinchable">Pinchable</a> a, <a href="Pinch.html#t:Tag">Tag</a> a ~ <a href="Pinch.html#t:TStruct">TStruct</a>) =&gt; <a href="Pinch.html#t:Message">Message</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Either.html#t:Either">Either</a> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch.hs#L317" class="link">Source</a></p><div class="doc"><p>Read the message contents.</p><p>This returns a <code>Left</code> result if the message contents do not match the
 requested type.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:MessageType" class="def">MessageType</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/Message.hs#L31" class="link">Source</a></p><div class="doc"><p>Type of message being sent.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Call" class="def">Call</a></td><td class="doc"><p>A call to a specific method.</p><p>The message body is the request arguments struct.</p></td></tr><tr><td class="src"><a name="v:Reply" class="def">Reply</a></td><td class="doc"><p>Response to a call.</p><p>The message body is the response union.</p></td></tr><tr><td class="src"><a name="v:Exception" class="def">Exception</a></td><td class="doc"><p>Failure to make a call.</p><p>Note: This message type is <em>not</em> used for exceptions that are defined
 under the <code>throws</code> clause of a method. Those exceptions are part of the
 response union of the method and are received in a <code>Reply</code>. This
 message type is used for Thrift-level failures.</p></td></tr><tr><td class="src"><a name="v:Oneway" class="def">Oneway</a></td><td class="doc"><p>One-way call that expects no response.</p></td></tr></table></div><div class="subs instances"><p id="control.i:MessageType" class="caption collapser" onclick="toggleSection('i:MessageType')">Instances</p><div id="section.i:MessageType" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Data.html#t:Data">Data</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Generic">Generic</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/deepseq/latest/doc/html/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/GHC-Generics.html#t:Rep">Rep</a> <a href="Pinch.html#t:MessageType">MessageType</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:17">Protocols</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Protocol" class="def">Protocol</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Protocol.hs#L26" class="link">Source</a></p><div class="doc"><p>Protocols define a specific way to convert values into binary and back.</p></div></div><div class="top"><p class="src"><a name="v:binaryProtocol" class="def">binaryProtocol</a> :: <a href="Pinch.html#t:Protocol">Protocol</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Protocol/Binary.hs#L45" class="link">Source</a></p><div class="doc"><p>Provides an implementation of the Thrift Binary Protocol.</p></div></div><h1 id="g:18">TType</h1><div class="doc"><p>TType is used to refer to the Thrift protocol-level type of a value.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TType" class="def">TType</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L101" class="link">Source</a></p><div class="doc"><p>Represents the type of a Thrift value.</p><p>Objects of this type are tagged with one of the TType tags, so this type
 also acts as a singleton on the TTypes. It allows writing code that can
 enforce properties about the TType of values at compile time.</p></div><div class="subs instances"><p id="control.i:TType" class="caption collapser" onclick="toggleSection('i:TType')">Instances</p><div id="section.i:TType" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Eq.html#t:Eq">Eq</a> (<a href="Pinch.html#t:TType">TType</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Show.html#t:Show">Show</a> (<a href="Pinch.html#t:TType">TType</a> a)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="http://hackage.haskell.org/packages/archive/hashable/latest/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> (<a href="Pinch.html#t:TType">TType</a> a)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Typeable-Internal.html#t:Typeable">Typeable</a> a =&gt; <a name="t:IsTType" class="def">IsTType</a> a <span class="keyword">where</span> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L134" class="link">Source</a></p><div class="doc"><p>Typeclass used to map type-leve TTypes into <code><a href="Pinch.html#t:TType">TType</a></code> objects. All TType
 tags are instances of this class.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:ttype" class="def">ttype</a> :: <a href="Pinch.html#t:TType">TType</a> a <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L134" class="link">Source</a></p><div class="doc"><p>Based on the context in which this is used, it will automatically
 return the corresponding <code><a href="Pinch.html#t:TType">TType</a></code> object.</p></div></div><div class="subs instances"><p id="control.i:IsTType" class="caption collapser" onclick="toggleSection('i:IsTType')">Instances</p><div id="section.i:IsTType" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TList">TList</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TSet">TSet</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TMap">TMap</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TStruct">TStruct</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TBinary">TBinary</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt64">TInt64</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt32">TInt32</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt16">TInt16</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TDouble">TDouble</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TByte">TByte</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TBool">TBool</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h2 id="g:19">Tags</h2><div class="doc"><p>TType tags allow writing code that depends on knowing the <code>TType</code> of
 values, or asserting conditions on it, at compile time.</p><p>For example, values in a map, list, or set must all have the same TType.
 This is enforced at the type level by parameterizing <code><a href="Pinch.html#t:Value">Value</a></code> over these
 tags.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TBool" class="def">TBool</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L51" class="link">Source</a></p><div class="doc"><pre>bool</pre></div><div class="subs instances"><p id="control.i:TBool" class="caption collapser" onclick="toggleSection('i:TBool')">Instances</p><div id="section.i:TBool" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TBool">TBool</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TByte" class="def">TByte</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L54" class="link">Source</a></p><div class="doc"><pre>byte</pre></div><div class="subs instances"><p id="control.i:TByte" class="caption collapser" onclick="toggleSection('i:TByte')">Instances</p><div id="section.i:TByte" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TByte">TByte</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TDouble" class="def">TDouble</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L57" class="link">Source</a></p><div class="doc"><pre>double</pre></div><div class="subs instances"><p id="control.i:TDouble" class="caption collapser" onclick="toggleSection('i:TDouble')">Instances</p><div id="section.i:TDouble" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TDouble">TDouble</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:TEnum" class="def">TEnum</a> = <a href="Pinch.html#t:TInt32">TInt32</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L66" class="link">Source</a></p><div class="doc"><pre>enum</pre></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TInt16" class="def">TInt16</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L60" class="link">Source</a></p><div class="doc"><pre>i16</pre></div><div class="subs instances"><p id="control.i:TInt16" class="caption collapser" onclick="toggleSection('i:TInt16')">Instances</p><div id="section.i:TInt16" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt16">TInt16</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TInt32" class="def">TInt32</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L63" class="link">Source</a></p><div class="doc"><pre>i32</pre></div><div class="subs instances"><p id="control.i:TInt32" class="caption collapser" onclick="toggleSection('i:TInt32')">Instances</p><div id="section.i:TInt32" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt32">TInt32</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TInt64" class="def">TInt64</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L69" class="link">Source</a></p><div class="doc"><pre>i64</pre></div><div class="subs instances"><p id="control.i:TInt64" class="caption collapser" onclick="toggleSection('i:TInt64')">Instances</p><div id="section.i:TInt64" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TInt64">TInt64</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TBinary" class="def">TBinary</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L72" class="link">Source</a></p><div class="doc"><pre>binary</pre></div><div class="subs instances"><p id="control.i:TBinary" class="caption collapser" onclick="toggleSection('i:TBinary')">Instances</p><div id="section.i:TBinary" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TBinary">TBinary</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TStruct" class="def">TStruct</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L78" class="link">Source</a></p><div class="doc"><pre>struct</pre></div><div class="subs instances"><p id="control.i:TStruct" class="caption collapser" onclick="toggleSection('i:TStruct')">Instances</p><div id="section.i:TStruct" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TStruct">TStruct</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:TUnion" class="def">TUnion</a> = <a href="Pinch.html#t:TStruct">TStruct</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L81" class="link">Source</a></p><div class="doc"><pre>union</pre></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:TException" class="def">TException</a> = <a href="Pinch.html#t:TStruct">TStruct</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L84" class="link">Source</a></p><div class="doc"><pre>exception</pre></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TMap" class="def">TMap</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L87" class="link">Source</a></p><div class="doc"><pre>map&lt;k, v&gt;</pre></div><div class="subs instances"><p id="control.i:TMap" class="caption collapser" onclick="toggleSection('i:TMap')">Instances</p><div id="section.i:TMap" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TMap">TMap</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TSet" class="def">TSet</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L90" class="link">Source</a></p><div class="doc"><pre>set&lt;x&gt;</pre></div><div class="subs instances"><p id="control.i:TSet" class="caption collapser" onclick="toggleSection('i:TSet')">Instances</p><div id="section.i:TSet" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TSet">TSet</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TList" class="def">TList</a> <a href="https://github.com/abhinav/pinch/tree/master/src/Pinch/Internal/TType.hs#L93" class="link">Source</a></p><div class="doc"><pre>list&lt;x&gt;</pre></div><div class="subs instances"><p id="control.i:TList" class="caption collapser" onclick="toggleSection('i:TList')">Instances</p><div id="section.i:TList" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Pinch.html#t:IsTType">IsTType</a> <a href="Pinch.html#t:TList">TList</a></span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>